{{define "head" -}}
    {{- $bgColorLight := "white" -}}
    {{- $bgColorDark := "#282A36" -}}
    {{- $colorThemeMap := dict "light" $bgColorLight "dark" $bgColorDark -}}
    <!DOCTYPE html>
    <html lang="en" {{if .UISettings}}data-theme="{{.UISettings.Theme}}"{{end}}>
	<head>
	    <meta charset="UTF-8">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <meta name="color-scheme" content="dark light" />
	    <meta name="theme-color" content="{{get $colorThemeMap .UISettings.Theme}}" />
	    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
	    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
	    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
	    <link rel="manifest" href="/static/site.webmanifest">
	    <title>{{.Title}} - {{.Slogan}}</title>
	    <style>
	     :root{
		 --font-size: 16px;
		 --colored-bg: #BED3E5;
		 --tip-bg: #E5E4BE;
		 --theme-color: #2F71AC;
		 --theme-color-darken: #5050DC;
		 --border-color-active: var(--theme-color);
		 --reply-indent-size: 2rem;
	     }
	     :root[data-theme="light"] {
		 color-scheme: light;
		 --text: black;
		 --background: {{$bgColorLight}};
		 --background-hover: #FAFAFA;

		 --text-with-background: black;
		 --text-lighten: #333;
		 --text-lighten-2: #666;
		 --text-lighten-3: #999;

		 --link-visited: #9A3D9A;

		 --border-color: #CCC;
	     }
	     :root[data-theme="dark"] {
		 color-scheme: dark;
		 --theme-color: #74BCFB;
		 --theme-color-darken: #8C8CDC;
		 --text: white;
		 --background: {{$bgColorDark}};
		 --background-hover: #383A45;

		 --text-with-background: black;
		 --text-lighten: #DDD;
		 --text-lighten-2: #CCC;
		 --text-lighten-3: #AAA;

		 --link-visited: #A35FA3;

		 --border-color: #666;
	     }
	     h1{
		 margin-bottom: 0.6rem;
	     }
	     a {
		 text-decoration: none;
		 color: var(--theme-color);
	     }
	     a:active{
		 color: var(--theme-color-darken);
	     }
	     a:visited{
		 color: var(--link-visited);
	     }
	     a:hover,
	     a:focus-visible{
		 text-decoration: underline;
	     }
	     
	     input,
	     textarea,
	     button{
		 font-size: var(--font-size)
	     }

	     input[type="text"],
	     textarea{
		 max-width: 1000px;
	     }

	     html{
		 font-size: var(--font-size)
	     }
	     html,body{
		 background: var(--background);
		 color: var(--text);
	     }
	     body{
		 margin: 0 auto;
		 padding: 10px 12px;
		 {{- if and .UISettings (eq .UISettings.ContentLayout "centered") -}}
		 max-width: 1000px;
		 {{- end -}}
		 font-family: Helvetica, sans-serif, Noto Sans, Microsoft YaHei, Microsoft JhengHei, PingFang, Noto Color Emoji;
	     }
	     a.brand{
		 display: inline-block;
		 font-weight: bold;
		 font-size: 1.2rem;
		 color: var(--theme-color);
	     }
	     .slogan{
		 font-size: 0.8rem;
	     }
	     .text-lighten,
	     a.text-lighten{
		 color: var(--text-lighten)
	     }
	     .text-lighten-2,
	     a.text-lighten-2{
		 color: var(--text-lighten-2)
	     }
	     .text-lighten-3,
	     a.text-lighten-3{
		 color: var(--text-lighten-3)
	     }
	     .page-tip{
		 display:flex;
		 padding: 10px;
		 margin-bottom: 10px;
		 justify-content:space-between;
		 background-color: var(--tip-bg);
		 color: var(--text-with-background)
	     }
	     .page-tip a{
		 color: var(--text-with-background)
	     }
	     .article-list{
		 padding-left: 2rem;
	     }
	     .article-list li{
		 margin-bottom: 10px;
	     }
	     .article-list li a:active,
	     .article-list li a:focus{
		 border: 1px dashed #ccc;
	     }
	     .skip-button{
		 position: fixed;
		 left: 0;
		 top: 0;
		 width: 100%;
		 height: 0;
		 line-height: 2.4rem;
		 background: var(--background);
		 text-align: center;
		 overflow: hidden;
	     }
	     .skip-button:focus-visible{
		 height: auto;
		 outline: 1px solid blue;
		 text-decoration: underline;
	     }
	     .tabs{
		 padding: 4px 10px 0;
		 border-bottom: 1px solid var(--border-color);
		 margin-bottom: 10px
	     }
	     .tabs .tab{
		 display: inline-block;
		 padding: 0 10px 4px;
		 margin-bottom: -1px;
		 line-height: 28px;
		 color: var(--text-lighten);
		 font-size: 0.9rem;
	     }
	     .tabs .tab.active{
		 color: var(--text-color);
		 border-bottom: 2px solid var(--border-color-active);
	     }
	     .data-list{
		 display: table;
		 width: 100%;
	     }
	     .data-list .data-list__row{
		 display: table-row;
	     }
	     .data-list .data-list__label,
	     .data-list .data-list__content{
		 display: table-cell;
		 padding-bottom: 10px;
		 vertical-align: top;
	     }
	     .data-list .data-list__label{
		 width: 7rem;
		 text-align: right;
		 padding-right: 6px;
		 box-sizing: border-box;
	     }
	     .data-list .data-list__content{
		 text-align: left;
	     }
	     .form .form__row{
		 margin-bottom: 12px;
	     }
	     .form .form__row > label{
		 display: block;
		 margin-bottom: 6px;
		 font-weight: bold;
	     }
	     .form .form__row:last-child{
		 margin-bottom: 0;
	     }
	     .vote-form{
		 display: inline-block;
		 padding: 0;
		 margin: 0;
		 vertical-align: text-top;
		 line-height: 0;
	     }
	     .vote-form button[type="submit"]{
		 display: inline-block;
		 padding: 0;
		 border: none;
		 line-height: 1;
		 vertical-align: text-top;
		 font-size: 1rem;
		 cursor: pointer;
		 background: transparent;
		 color: var(--text-lighten-2);
	     }
	     .vote-form button[type="submit"]:hover,
	     .vote-form button[type="submit"]:hover svg{
		 color: var(--text-lighten-3);
	     }
	     .vote-form.voted button[type="submit"],
	     .vote-form.voted button[type="submit"] svg{
		 color: var(--theme-color);
	     }
	     .btn-vote--up,
	     .btn-vote--down{
		 position: relative;
	     }
	     .btn-vote--up{
		 top: 1px;
	     }
	     .btn-vote--down{
		 margin-left: 0.5rem;
		 margin-right: 0.5rem;
	     }

	     .article-operation{
		 display: flex;
		 justify-content: space-between;
	     }
	     .article-operation,
	     .article-operation a,
	     .article-operation svg,
	     .article-operation button[type="submit"]{
		 color: var(--text-lighten-2);
		 
	     }
	     
	     .article-operation svg,
	     .article-operation a{
		 display: inline-block;
		 vertical-align: baseline;
	     }
	     .article-operation svg{
		 vertical-align: -1px;
	     }

	     .article-operation .btn-form{
		 display: inline;
		 margin: 0;
		 padding: 0;
	     }
	     .article-operation .btn-form button[type="submit"]{
		 appearance: none;
		 display: inline-block;
		 margin: 0;
		 padding: 0;
		 border: none;
		 background: transparent;
		 cursor: pointer;
		 font-family: inherit;
		 font-size: inherit;
		 vertical-align: inherit;
	     }

	     .article-operation .btn-form button[type="submit"]:hover{
		 text-decoration: underline;
	     }

	     .article-reacts{
		 display: inline-block;
		 vertical-align: baseline;
	     }
	     .article-reacts form>span{
		 cursor: pointer;
	     }

	     .article-operation .btn-react{
		 position: relative;
		 padding: 0 4px;
		 margin-right: 4px;
		 vertical-align: baseline;
	     }
	     .article-operation .btn-react:last-child{
		 margin-right: 0;
	     }
	     .article-operation .btn-react > a,
	     .article-operation .btn-react > span,
	     .article-operation .btn-react > label,
	     .article-operation .btn-react > a > svg{
		 white-space: nowrap;
		 position: relative;
		 z-index: 2;
	     }
	     .article-operation .btn-react select{
		 position: absolute;
		 right: 0;
		 top: 0;
		 appearance: none;
		 width: 100%;
		 height: 100%;
		 padding: 0;
		 margin: 0;
		 border: none;
		 z-index: 10;
		 background: transparent;
		 cursor: pointer;
	     }

	     .article-operation .btn-form{
		 display: inline-block;
	     }
	     
	     .article-operation .btn-react.btn-react--selected{
		 border: 1px solid var(--theme-color);
		 border-radius: 1rem;
		 text-align: center;
	     }

	     .article-placeholder{
		 padding: 4px 0;
		 cursor: pointer;
	     }

	     @media (max-width: 750px){
		 :root{
		     --reply-indent-size: 1rem;
		 }
	     }
	    </style>
	    <script>
	     /* document.addEventListener("DOMContentLoaded", function(){
		var selectedTheme = localStorage.getItem("theme")
		if (selectedTheme){
		setTheme(selectedTheme)
		} else {
		if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
		setTheme("dark")
		} else {
		setTheme("light")
		}
		}
		})

		window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
		setTheme("system")
		});

		function onThemeChange(ev){
		setTheme(ev.target.value)
		}

		function setTheme(themeName){
		document.getElementById("theme").value = themeName
		localStorage.setItem("theme", themeName)

		if (themeName == "system") {
		if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
		themeName = "dark"
		} else {
		themeName = "light"
		}
		}
		document.documentElement.setAttribute("data-theme", themeName)
		} */
	    </script>
	</head>
	<body>
	    {{- if or (eq .RoutePath "/") (eq .RoutePath "/articles") -}}
		<a id="skip-button" class="skip-button" tab-index="0" href="#article-list-head">Skip To Content</a>
	    {{- end -}}
	    {{- if and .Debug .JSONStr -}}
	    <script>
	     const DEBUG_DATA = {{.JSONStr -}};
	     console.dir(DEBUG_DATA);
	    </script>
	    {{- end -}}
	    <style>
	     .top-nav {
		 display: flex;
		 justify-content: space-between;
		 /* flex-wrap: wrap; */
		 align-items: flex-start;
		 margin-bottom: 10px;
	     }
	     .nav-menu{
		 display: flex;
		 flex-wrap: wrap;
		 align-items: center;
		 list-style: none;
		 margin: 0;
		 padding: 0;
	     }
	     .nav-menu li{
		 vertical-align: middle;
		 margin-right: 10px;
		 line-height: 1.2rem;
	     }
	     .nav-menu li:last-child{
		 margin-right: 0;
	     }
	     .nav-menu li a{
		 /* color: var(--text-color) */
	     }
	     .nav-menu.nav-menu--left{
		 flex: 1 0 auto;
	     }
	     .nav-menu.nav-menu--right{
		 justify-content: flex-end;
	     }
	    </style>
	    <nav class="top-nav">
		<ul class="nav-menu nav-menu--left">
		    <li><a class="brand logo" href="/">{{.BrandName}}</a></li>
		    {{- range .BreadCrumbs -}}
			<li><b><a href="{{.Path}}">{{.Name}}</a></b></li>
		    {{- end -}}
		</ul>
		<ul class="nav-menu nav-menu--right">
		    <li><a href="/articles/new">&plus;New</a></li>
		    {{- if .Debug -}}
			<li><a href="/users">Users</a></li>
		    {{- end -}}
		    {{if .LoginedUser -}}
			<li><a href="/users/{{.LoginedUser.Id}}">{{.LoginedUser.Name}}</a></li>
			{{- if .Debug }}
			    <li>
				<form action="/login_debug" method="post">
				    {{.CSRFField}}
				    <select id="debug-user" name="debug-user-email" onchange="this.parentNode.submit()">
					{{- $loginedUser := .LoginedUser -}}
					{{- range .DebugUsers -}}
					    <option value="{{.Email}}" {{if eq $loginedUser.Email .Email}}selected{{end}}>{{.Name}}</option>
					{{- end -}}
				    </select>
				</form>
			    </li>
			{{- end -}}
			<li><a href="/logout">Logout</a></li>
		    {{else -}}
			<li><a href="/register">Register</a></li>
			<li><a href="/login">Login</a></li>
		    {{end -}}
		    <li>
			<a href="/settings">Settings</a>
		    </li>
		</ul>
	    </nav>
	    <!-- <hr/> -->
	    {{range .TipMsg -}}
		<div id="page-tip" class="page-tip">
		    <span>{{.}}</span>
		    <a href="" onclick="javascript:this.parentNode.remove();return false;">&nbsp;&times;&nbsp;</a>
		</div>
	    {{end -}}
{{- end -}}
